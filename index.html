
<!DOCTYPE html>
<html lang="mr">
<head>
  <meta charset="UTF-8">
  <title>1995 Batchamates ‡§∏‡•ç‡§®‡•á‡§π‡§∏‡§Ç‡§Æ‡•á‡§≤‡§® 2025</title>
  <style>
    body { font-family: "Noto Sans Devanagari", Arial, sans-serif; background: #f4f4f4; margin: 0; padding: 0; }
    header { background: #0077cc; color: #fff; padding: 15px; text-align: center; }
    header img { height: 80px; display:block; margin:0 auto 10px auto; }
    h1 { margin: 0; font-size: 28px; }
    main { padding: 20px; }
    form { background:#fff; padding:15px; border-radius:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1); margin-bottom:20px; }
    label { display:block; margin-top:10px; }
    input, select { width:100%; padding:8px; margin-top:5px; border:1px solid #ccc; border-radius:5px; }
    button { background:#0077cc; color:#fff; padding:10px 20px; border:none; border-radius:5px; margin-top:10px; cursor:pointer; }
    button:hover { background:#005fa3; }
    table { width:100%; border-collapse: collapse; margin-top:20px; background:#fff; }
    th, td { border:1px solid #ccc; padding:10px; text-align:center; }
    th { background:#0077cc; color:#fff; }
    tfoot td { font-weight:bold; background:#f0f0f0; }
    .balance { font-size:20px; font-weight:bold; margin-top:20px; }
    .credit { color:green; font-weight:bold; }
    .debit { color:red; font-weight:bold; }
  </style>
</head>
<body>
  <header>
    <img src="IMG_0143.jpeg" alt="Logo">
    <h1>1995 Batchamates ‡§∏‡•ç‡§®‡•á‡§π‡§∏‡§Ç‡§Æ‡•á‡§≤‡§® 2025</h1>
  </header>

  <main>
    <form id="entryForm">
      <label>‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï:</label>
      <input type="date" id="date" required>

      <label>‡§®‡§æ‡§µ:</label>
      <input type="text" id="name" required>

      <label>‡§™‡•ç‡§∞‡§ï‡§æ‡§∞:</label>
      <select id="type">
        <option value="credit">‡§ú‡§Æ‡§æ</option>
        <option value="debit">‡§ñ‡§∞‡•ç‡§ö</option>
      </select>

      <label>‡§∞‡§ï‡•ç‡§ï‡§Æ:</label>
      <input type="number" id="amount" required>

      <button type="submit">‡§®‡•ã‡§Ç‡§¶ ‡§ï‡§∞‡§æ</button>
    </form>

    <table>
      <thead>
        <tr>
          <th>‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï</th>
          <th>‡§®‡§æ‡§µ</th>
          <th>‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</th>
          <th>‡§∞‡§ï‡•ç‡§ï‡§Æ (‚Çπ)</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>

    <div class="balance">‡§è‡§ï‡•Ç‡§£ ‡§∂‡§ø‡§≤‡•ç‡§≤‡§ï: ‚Çπ <span id="balance">0</span></div>
    <button onclick="downloadCSV()">CSV ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°</button>
  </main>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
    import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-database.js";

    // üî• Firebase Config (Realtime Database URL ‡§≤‡§ï‡•ç‡§∑‡§æ‡§§ ‡§†‡•á‡§µ)
    const firebaseConfig = {
      apiKey: "AIzaSyBhrHcBSK1G1EmFW12_eBfA14mHhZd1MdI",
      authDomain: "batch1995-11ec2.firebaseapp.com",
      databaseURL: "https://batch1995-11ec2-default-rtdb.firebaseio.com",
      projectId: "batch1995-11ec2",
      storageBucket: "batch1995-11ec2.appspot.com",
      messagingSenderId: "386074895473",
      appId: "1:386074895473:web:6e14f976479aeb0c68a7d0"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const form = document.getElementById("entryForm");
    const tableBody = document.getElementById("tableBody");
    const balanceEl = document.getElementById("balance");
    let allData = [];

    // ‚úÖ ‡§®‡•ã‡§Ç‡§¶ ‡§ï‡§∞‡§æ
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const date = document.getElementById("date").value;
      const name = document.getElementById("name").value;
      const type = document.getElementById("type").value;
      const amount = parseFloat(document.getElementById("amount").value);

      if (!date || !name || !amount) return;

      try {
        await push(ref(db, "transactions"), { date, name, type, amount });
        form.reset();
      } catch (err) {
        console.error("DB add error:", err);
      }
    });

    // ‚úÖ Live ‡§°‡•á‡§ü‡§æ fetch
    onValue(ref(db, "transactions"), (snapshot) => {
      tableBody.innerHTML = "";
      allData = [];
      let balance = 0;

      snapshot.forEach((child) => {
        const d = child.val();
        allData.push(d);
        balance += d.type === "credit" ? d.amount : -d.amount;

        tableBody.innerHTML += `
          <tr>
            <td>${d.date}</td>
            <td>${d.name}</td>
            <td class="${d.type==="credit"?"credit":"debit"}">${d.type==="credit"?"‡§ú‡§Æ‡§æ":"‡§ñ‡§∞‡•ç‡§ö"}</td>
            <td>${d.amount}</td>
          </tr>`;
      });

      balanceEl.textContent = balance;
    });

    // ‚úÖ CSV ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°
    function downloadCSV() {
      if (allData.length === 0) {
        alert("‡§ï‡•ã‡§£‡§§‡§æ‡§π‡•Ä ‡§°‡•á‡§ü‡§æ ‡§®‡§æ‡§π‡•Ä");
        return;
      }
      let csv = "‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï,‡§®‡§æ‡§µ,‡§™‡•ç‡§∞‡§ï‡§æ‡§∞,‡§∞‡§ï‡•ç‡§ï‡§Æ\n";
      allData.forEach(d => {
        csv += `${d.date},${d.name},${d.type==="credit"?"‡§ú‡§Æ‡§æ":"‡§ñ‡§∞‡•ç‡§ö"},${d.amount}\n`;
      });
      const blob = new Blob([csv], { type: "text/csv" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "transactions.csv";
      a.click();
    }
    window.downloadCSV = downloadCSV;
  </script>
</body>
</html>
