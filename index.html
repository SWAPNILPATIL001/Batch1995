<!DOCTYPE html>
<html lang="mr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>१९९५ Batchmates स्नेहसंमेलन २०२५</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Poppins', sans-serif; margin: 0; padding: 0; background: #f8f9fa; color: #333; }
    header { background: #0d6efd; color: #fff; padding: 15px; text-align: center; }
    header img { height: 50px; vertical-align: middle; }
    .container { max-width: 800px; margin: 20px auto; background: #fff; padding: 20px; border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    h2 { text-align: center; margin-bottom: 20px; }
    form { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; }
    form select, form input, form button { padding: 10px; border: 1px solid #ccc; border-radius: 4px; flex: 1; }
    table { width: 100%; border-collapse: collapse; }
    table, th, td { border: 1px solid #ddd; }
    th, td { padding: 10px; text-align: center; }
    .actions button { margin: 0 3px; padding: 5px 10px; border: none; border-radius: 4px; cursor: pointer; }
    .edit { background: #ffc107; }
    .delete { background: #dc3545; color: #fff; }
    .cancel { background: #6c757d; color: #fff; }
  </style>
</head>
<body>
  <header>
    <h1>1195 Batchmates</h1>
    <!-- Firebase Storage मधून लोगोचा URL टाका -->
    <img src="IMG_0143.jpeg" alt="Batchmates Logo">
  </header>

  <div class="container">
    <h2>नवीन नोंद</h2>
    <form id="entryForm">
      <select id="type" required>
        <option value="credit">जमा (Credit)</option>
        <option value="debit">खर्च (Debit)</option>
      </select>
      <input type="text" id="name" placeholder="नाव" required>
      <input type="date" id="date" required>
      <input type="number" id="amount" placeholder="रक्कम" required>
      <button type="submit">नोंद जोडा</button>
    </form>

    <h2>नोंदी</h2>
    <table>
      <thead>
        <tr>
          <th>प्रकार</th>
          <th>नाव</th>
          <th>तारीख</th>
          <th>रक्कम</th>
          <th>कृती</th>
        </tr>
      </thead>
      <tbody id="recordsTable"></tbody>
    </table>
  </div>

  <!-- Firebase SDKs -->
  <script type="module">
    // Import Firebase SDKs
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, updateDoc, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

    // तुमचं Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyBhrHcBSK1G1EmFW12_eBfA14mHhZd1MdI",
      authDomain: "batch1995-11ec2.firebaseapp.com",
      projectId: "batch1995-11ec2",
      storageBucket: "batch1995-11ec2.firebasestorage.app",
      messagingSenderId: "386074895473",
      appId: "1:386074895473:web:6e14f976479aeb0c68a7d0",
      measurementId: "G-4H1H2TPXYY"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const form = document.getElementById('entryForm');
    const table = document.getElementById('recordsTable');
    let editId = null;

    // डेटा टेबलमध्ये रेंडर करा
    async function renderTable() {
      table.innerHTML = '';
      const querySnapshot = await getDocs(collection(db, "records"));
      querySnapshot.forEach((docSnap) => {
        const rec = docSnap.data();
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${rec.type === 'credit' ? 'जमा' : 'खर्च'}</td>
          <td>${rec.name}</td>
          <td>${rec.date}</td>
          <td>${rec.amount}</td>
          <td class="actions">
            <button class="edit" onclick="editRecord('${docSnap.id}', '${rec.type}', '${rec.name}', '${rec.date}', '${rec.amount}')">Edit</button>
            <button class="delete" onclick="deleteRecord('${docSnap.id}')">Delete</button>
          </td>
        `;
        table.appendChild(row);
      });
    }

    // फॉर्म सबमिट
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const type = document.getElementById('type').value;
      const name = document.getElementById('name').value;
      const date = document.getElementById('date').value;
      const amount = document.getElementById('amount').value;

      if (editId) {
        const docRef = doc(db, "records", editId);
        await updateDoc(docRef, { type, name, date, amount });
        editId = null;
      } else {
        await addDoc(collection(db, "records"), { type, name, date, amount });
      }

      form.reset();
      renderTable();
    });

    // Edit record (global बनवलं window वर)
    window.editRecord = (id, type, name, date, amount) => {
      document.getElementById('type').value = type;
      document.getElementById('name').value = name;
      document.getElementById('date').value = date;
      document.getElementById('amount').value = amount;
      editId = id;
    };

    // Delete record
    window.deleteRecord = async (id) => {
      await deleteDoc(doc(db, "records", id));
      renderTable();
    };

    // सुरुवातीला डेटा लोड करा
    renderTable();
  </script>
</body>
</html>
